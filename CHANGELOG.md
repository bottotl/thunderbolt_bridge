# 更新日志 (CHANGELOG)

## v2.4 (2025-12-15) - 智能网卡选择

### 新功能
- ✨ **优先使用有线网卡**: 所有脚本现在会优先检测并使用有线网卡（以太网）共享网络
- 🔄 **自动回退机制**: 如果没有活跃的有线网卡，自动回退到WiFi
- 📊 **显示接口类型**: 脚本执行时会明确显示使用的是有线还是无线接口
- 🔌 **全面支持USB网卡**: 支持识别各种类型的有线网卡，包括：
  - USB 10/100/1000 LAN（USB网卡）
  - Ethernet Adapter（雷雳/USB-C扩展坞）
  - 内置以太网接口
  - Thunderbolt Ethernet等其他有线接口

### 重要修复
- 🐛 **修复USB网卡识别问题**: 之前只匹配"Ethernet"关键字，导致"USB 10/100/1000 LAN"等非标准命名的接口无法识别
- 🎯 **改进检测算法**: 使用排除法而非关键字匹配，自动排除WiFi、蓝牙、雷雳网桥等虚拟/无线接口，识别所有真实的有线网卡

### 修改的文件
1. **persistent_bridge_setup.sh**
   - 添加有线网卡优先检测逻辑（第118-147行）
   - 更新NAT规则注释，标注共享接口类型

2. **bridge_network_setup.sh**
   - 添加有线网卡优先检测逻辑（第77-102行）
   - 更新NAT规则注释，标注共享接口类型

3. **bridge_monitor.sh**
   - 重命名 `check_wifi_status()` 为 `check_internet_status()`
   - 添加有线网卡优先检测逻辑（第186-206行）
   - 更新健康检查显示文本

4. **CLAUDE.md**
   - 更新网络架构说明，体现有线优先策略
   - 添加v2.4版本说明

### 新增文件
- **test_interface_detection.sh**: 测试网络接口检测逻辑的工具脚本

### 网络接口选择优先级
```
1. 以太网（有线网卡）- 如果存在且状态为 active
2. WiFi（无线网卡）- 如果没有活跃的有线网卡
3. en0（默认）- 如果以上都未找到
```

### 使用场景
此更新特别适合以下场景：
- MacBook 通过扩展坞或适配器连接有线网络
- 需要更稳定的网络共享（有线网络通常比WiFi更稳定）
- 同时有有线和无线连接时，优先使用带宽更大的有线连接

### 兼容性
- ✅ 完全向后兼容之前的版本
- ✅ 如果系统只有WiFi，行为与之前版本完全一致
- ✅ 不需要重新运行配置脚本即可生效（下次运行时自动应用）

---

## v2.3 (2024) - 用户体验优化

### 改进
- 引导用户从临时脚本升级到持久化方案
- 优化脚本输出信息
- 添加更多使用提示

---

## v2.2 (2024) - 高级监控工具

### 新功能
- 添加 bridge_monitor.sh 实时监控脚本
- 彩色状态显示
- 智能故障检测
- 详细健康检查

---

## v2.1 (2024) - 系统服务集成

### 新功能
- 添加 install_daemon.sh 系统服务安装脚本
- LaunchDaemon 自动启动配置
- 系统级监控和修复

---

## v2.0 (2024) - 持久化配置方案

### 新功能
- persistent_bridge_setup.sh 持久化配置脚本
- 配置在重启后自动保持
- NAT规则持久化
- IP转发持久化

---

## v1.0 (2024) - 基础版本

### 功能
- bridge_network_setup.sh 主机端临时配置
- client_network_setup.sh 客户端配置
- 基础雷雳桥接网络功能
